soundpool 
STREAM_SYSTEM_ENFORCED

Option Explicit

Sub getAllDtsStatus()

Dim i, j, row As Integer
Dim team, dts As Worksheet
Dim name As String


Set team = ThisWorkbook.Worksheets("team")
Set dts = ThisWorkbook.Worksheets("缺陷关注")

row = getSheetLine(dts)

Debug.Print row

row = team.UsedRange.Rows.count
Debug.Print ThisWorkbook.Path



For i = 2 To row

    If team.Range("A" & i).Value = "" Then
        Exit For
    End If
    
    name = ThisWorkbook.Path + "\" + team.Range("A" & i).Value + ".xlsx"

    If Dir(name) <> "" Then
        'Debug.Print name + "文件存在"
        Call openExcel(name)
    Else
        Debug.Print name + "不文件存在"
    End If

Next i

End Sub

Function openExcel(name As String)

Dim wb As Workbook
Dim i, j, k, m, n As Integer
Dim sheetFrom As Worksheet
Dim target As Worksheet
Dim exsits As Boolean

Debug.Print name

Set wb = Workbooks.Open(name)

Set sheetFrom = wb.Worksheets("缺陷关注")

i = getSheetLine(sheetFrom) 'from表格行数

Set target = ThisWorkbook.Worksheets("缺陷关注")

j = getSheetLine(target) 'target表格行数

For n = 2 To i

    exsits = False

    For m = 3 To j
    
        'Debug.Print sheetFrom.Range("A" & n).Value
        'Debug.Print target.Range("A" & m).Value
        
        If sheetFrom.Range("A" & n).Value = target.Range("A" & m).Value Then
        
            exsits = True
            
            Debug.Print "update dts" + target.Range("A" & m).Value
            
            target.Range("A" & m).Value = sheetFrom.Range("A" & n).Value
            target.Range("B" & m).Value = sheetFrom.Range("B" & n).Value
            target.Range("C" & m).Value = sheetFrom.Range("C" & n).Value
            target.Range("D" & m).Value = sheetFrom.Range("D" & n).Value
            target.Range("E" & m).Value = sheetFrom.Range("E" & n).Value
            target.Range("F" & m).Value = sheetFrom.Range("F" & n).Value
            target.Range("G" & m).Value = sheetFrom.Range("G" & n).Value
            target.Range("H" & m).Value = sheetFrom.Range("H" & n).Value
            target.Range("I" & m).Value = sheetFrom.Range("I" & n).Value
            target.Range("J" & m).Value = sheetFrom.Range("J" & n).Value
            target.Range("K" & m).Value = sheetFrom.Range("K" & n).Value
            target.Range("L" & m).Value = sheetFrom.Range("L" & n).Value
            target.Range("M" & m).Value = sheetFrom.Range("M" & n).Value
            target.Range("N" & m).Value = sheetFrom.Range("N" & n).Value
            target.Range("O" & m).Value = sheetFrom.Range("O" & n).Value
            
            Exit For
            
        
        End If
    
    Next m
    
    If exsits = False Then
    
        Debug.Print "add new dts"
    
        '新增加一行
        j = j + 1
        
        target.Range("A" & j).Value = sheetFrom.Range("A" & n).Value
        target.Range("B" & j).Value = sheetFrom.Range("B" & n).Value
        target.Range("C" & j).Value = sheetFrom.Range("C" & n).Value
        target.Range("D" & j).Value = sheetFrom.Range("D" & n).Value
        target.Range("E" & j).Value = sheetFrom.Range("E" & n).Value
        target.Range("F" & j).Value = sheetFrom.Range("F" & n).Value
        target.Range("G" & j).Value = sheetFrom.Range("G" & n).Value
        target.Range("H" & j).Value = sheetFrom.Range("H" & n).Value
        target.Range("I" & j).Value = sheetFrom.Range("I" & n).Value
        target.Range("J" & j).Value = sheetFrom.Range("J" & n).Value
        target.Range("K" & j).Value = sheetFrom.Range("K" & n).Value
        target.Range("L" & j).Value = sheetFrom.Range("L" & n).Value
        target.Range("M" & j).Value = sheetFrom.Range("M" & n).Value
        target.Range("N" & j).Value = sheetFrom.Range("N" & n).Value
        target.Range("O" & j).Value = sheetFrom.Range("O" & n).Value
    
    End If
    
    
    
    
    

Next n

wb.Close

End Function

Function getSheetLine(ByRef target As Worksheet) As Integer

Dim count As Integer

count = 2

If target.Range("A2").Value <> "" And target.Range("A3").Value = "" Then
    getSheetLine = count
Else

    While target.Range("A" & count).Value <> ""
        count = count + 1
    Wend
    
    getSheetLine = count - 1
    

End If


End Function
